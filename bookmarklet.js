javascript:(function(){let expandBtn=document.getElementById("toc-expand-btn")||(()=>{let b=document.createElement("button");b.id="toc-expand-btn";b.textContent="Expand";Object.assign(b.style,{position:"fixed",top:"10px",right:"0",zIndex:999999,cursor:"pointer",border:"1px solid #ccc",background:"#f0f0f0",padding:"4px 8px",display:"none"});document.body.appendChild(b);return b})();let buildTOC=function(){let root=document.querySelector("main")||document.body;let spans=Array.from(root.querySelectorAll("span[data-lexical-text]")).filter(s=>s.offsetParent!==null);let msgRoot=el=>el.closest("[data-message],[data-msg],[class*='message'],[class*='post'],article,li,div[role='listitem'],section,div")||el;let isUser=r=>true;let roots=[];spans.forEach(s=>{let r=msgRoot(s);if(r)roots.push(r)});roots=roots.filter((r,i,a)=>a.indexOf(r)===i);let userRoots=roots.filter(r=>isUser(r));let seen=new Set();userRoots=userRoots.filter(r=>{let t=(r.innerText||"").replace(/\s+/g," ").trim();if(!t||t.length<3||seen.has(t))return false;seen.add(t);return true});if(!userRoots.length){alert("No user asks found.");return}let old=document.getElementById("comet-toc");if(old)old.remove();let toc=document.createElement("div");toc.id="comet-toc";Object.assign(toc.style,{position:"fixed",top:"0",right:"0",width:"350px",height:"100%",overflowY:"auto",background:"#fff",borderLeft:"2px solid #ccc",padding:"12px",fontFamily:"sans-serif",fontSize:"14px",zIndex:999999,boxShadow:"0 0 8px "});let h=document.createElement("h3");h.style.marginTop="0";h.textContent="ðŸ“‘ My Asks";toc.appendChild(h);let ul=document.createElement("ul");ul.style.listStyle="none";ul.style.padding="0";userRoots.forEach((r,i)=>{if(!r.id)r.id="user-ask-"+i;let li=document.createElement("li");li.style.margin="6px 0";let a=document.createElement("a");a.href="#"+r.id;let numberSpan=document.createElement("span");numberSpan.textContent=(i+1)+". ";numberSpan.style.color="#FF4500";numberSpan.style.fontWeight="bold";a.appendChild(numberSpan);a.appendChild(document.createTextNode((r.innerText||"").replace(/\s+/g," ").trim()));a.style.textDecoration="none";a.style.color="#0366d6";a.addEventListener("click",e=>{e.preventDefault();document.getElementById(r.id).scrollIntoView({behavior:"smooth",block:"center"});history.replaceState(null,"","#"+r.id)});li.appendChild(a);ul.appendChild(li)});toc.appendChild(ul);let footer=document.createElement("div");footer.style.marginTop="20px";footer.style.fontSize="12px";footer.innerHTML='Created by <a href="https://muradul.com/" target="_blank">Murad</a>';toc.appendChild(footer);let hideBtn=document.createElement("button");hideBtn.textContent="Hide";Object.assign(hideBtn.style,{position:"absolute",top:"6px",right:"10px",cursor:"pointer",border:"1px solid #ccc",background:"#f0f0f0",padding:"2px 6px"});hideBtn.onclick=()=>{toc.remove();expandBtn.style.display="block"};toc.appendChild(hideBtn);expandBtn.style.display="none";document.body.appendChild(toc)};buildTOC();expandBtn.onclick=()=>{buildTOC()}})();
